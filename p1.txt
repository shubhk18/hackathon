#!/bin/bash

# Check if enough arguments are passed
if [ $# -ne 2 ]; then
  echo "Usage: $0 <template_file> <label_name>"
  exit 1
fi

# Input arguments
template_file="$1"
label_name="$2"
temp_file="temp_output.txt"

# Validate the template file exists
if [ ! -f "$template_file" ]; then
  echo "Error: Template file '$template_file' does not exist."
  exit 1
fi

# Extract content for the specified label
awk -v label="$label_name" '
  BEGIN {found=0} 
  # Match label (e.g., L1:)
  $0 ~ label ":" {found=1; next} 
  # Stop on the next label or end of file
  found && /^L[0-9]+:/ {found=0} 
  # Print content if inside the matching label
  found {print}
' "$template_file" > "$temp_file"

# Check if content was written
if [ -s "$temp_file" ]; then
  echo "Content for '$label_name' has been written to $temp_file."
else
  echo "Error: No content found for label '$label_name'."
  rm -f "$temp_file"
fi